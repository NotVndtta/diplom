<div class="w-full max-w-4xl">
  <div class="bg-white rounded-lg p-6">
    <h2 class="text-xl font-semibold text-gray-900 mb-4">Оставить отзыв</h2>
    
    <% if user_signed_in? %>
      <%= form_with model: Rating.new(rateable:), 
        url: (rateable.is_a?(User) ? profile_ratings_path(rateable) : polymorphic_path([rateable, :rating])),
        method: :post,
        data: { turbo: "_top" },
        class: "space-y-4" do |form| 
      %> 
        <div class="field">
          <%= form.label :comment, "Комментарий", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_area :comment, required: true, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-lime-500 focus:border-lime-500 text-sm" %>
          <%= form.hidden_field :rateable_id, value: rateable.id %>
          <%= form.hidden_field :rateable_type, value: rateable.class.name %>
        </div>

        <div class="field">
          <%= form.label :grade, "Оценка", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.select :grade, options_for_select([1, 2, 3, 4, 5]), { prompt: "Выберите оценку" }, { 
            class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-lime-500 focus:border-lime-500 text-sm",
            required: true 
          } %>
        </div>

        <div class="actions pt-2">
          <%= form.submit "Отправить", 
              class: "px-4 py-2 bg-lime-600 hover:bg-lime-700 text-white text-sm font-medium rounded-md shadow-sm" %>
        </div>
      <% end %>
    <% else %>
      <p class="text-sm text-gray-600">Чтобы оставить отзыв, пожалуйста <%= link_to "войдите", new_user_session_path, class: "text-lime-600 hover:text-lime-700" %>.</p>
    <% end %>
  </div>
</div>